# .goreleaser.yml
#
# test the config:
# goreleaser check
# goreleaser release --skip-publish --skip-validate --rm-dist

project_name: retrotxt
# make a variable description

before:
  hooks:
    - go mod tidy
builds:
  - id: Linux_Intel
    goos: ['linux']
    goarch: ['amd64']
  - id: macOS
    goos: ['darwin']
    goarch: ['amd64', 'arm64']
  - id: Windows
    goos: ['windows']
    goarch: ['amd64']
universal_binaries:
  - id: macOS
    name_template: "{{ .ProjectName }}"
    replace: true

archives:
  - id: Linux_Intel
    builds: ['Linux_Intel']
    format: tar.gz
    files:
    - none*
    name_template: "{{ .ProjectName }}_{{ .Os }}_{{ .Arch }}"
  - id: Linux arm
    builds: ['Linux arm']
    format: tar.gz
    files:
    - none*
    name_template: "{{ .ProjectName }}_{{ .Os }}_{{ .Arch }}"
  - id: macOS
    builds: ['macOS']
    format: tar.gz
    files:
    - none*
    name_template: "{{ .ProjectName }}_{{ .Os }}_{{ .Arch }}"
  - id: Windows
    builds: ['Windows']
    format: zip
    files:
    - none*
    name_template: "{{ .ProjectName }}_{{ .Os }}_{{ .Arch }}"

nfpms:
  - id: Linux
    builds: ['Linux_Intel']
    file_name_template: "{{ .ProjectName }}"
    vendor: Ben Garrett.
    homepage: https://retrotxt.com/go
    maintainer: Ben Garrett <code.by.ben@gmail.com>
    description: Read legacy codepage encoded textfiles in a modern Unicode terminal.
    license: LGPL 3.0
    formats:
      - apk
      - deb
      - rpm

scoops:
  - name: retrotxt
  - commit_author:
      name: goreleaserbot
      email: bot@goreleaser.com
  - commit_msg_template: "Scoop update for {{ .ProjectName }} version {{ .Tag }}"
  - homepage: https://retrotxt.com/go
  - description: Read legacy codepage encoded textfiles in a modern Unicode terminal.
  - license: LGPL 3.0
  # Setting this will prevent goreleaser to actually try to commit the updated
  # manifest leaving the responsibility of publishing it to the user.
  # If set to auto, the release will not be uploaded to the scoop bucket
  # in case there is an indicator for prerelease in the tag e.g. v1.0.0-rc1
  # Default is false.
  - skip_upload: auto

changelog:
  skip: false
  use: git